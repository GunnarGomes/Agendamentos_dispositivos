<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>

<body class="p-5">
    <div class="container">

        <h2 class="mb-4">Equipamentos Disponíveis</h2>

        <div class="mb-3">
            <a href="/equipamentos" class="btn btn-success">Gerenciar Equipamentos</a>
            <a href="/logout" class="btn btn-danger">Sair</a>
        </div>

        <!-- TABELA DE EQUIPAMENTOS -->
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Nome</th>
                    <th>Total</th>
                    <th>Usados</th>
                    <th>Disponíveis</th>
                    <th>Ação</th>
                </tr>
            </thead>
            <tbody>
            {% for eq in equipamentos %}
                <tr>
                    <td>{{ eq.nome }}</td>
                    <td>{{ eq.total }}</td>
                    <td>{{ eq.usados }}</td>
                    <td>
                        {% if eq.disponivel > 0 %}
                            <span class="text-success fw-bold">{{ eq.disponivel }}</span>
                        {% else %}
                            <span class="text-danger fw-bold">0</span>
                        {% endif %}
                    </td>
                    <td>
                        <a href="/agendar/{{ eq.id }}" class="btn btn-primary btn-sm">Agendar</a>
                    </td>
                </tr>
            {% else %}
                <tr><td colspan="5">Nenhum equipamento cadastrado.</td></tr>
            {% endfor %}
            </tbody>
        </table>


        <!-- NOVA SESSÃO: AGENDAMENTOS -->
        <h2 class="mt-5 mb-3">Agendamentos Realizados</h2>

        <table class="table table-striped table-bordered">
            <thead class="table-dark">
                <tr>
                    <th>Professor</th>
                    <th>Equipamento</th>
                    <th>Data</th>
                    <th>Turno</th>
                    <th>Aulas</th>
                    <th>Quantidade</th>
                </tr>
            </thead>
            <tbody>
            {% for ag in agendamentos %}
                <tr>
                    <td>{{ ag.user }}</td>
                    <td>{{ ag.equipment }}</td>
                    <td>{{ ag.date }}</td>

                    <td>
                        {% if ag.shift == 'morning' %}Manhã
                        {% elif ag.shift == 'afternoon' %}Tarde
                        {% elif ag.shift == 'night' %}Noite
                        {% else %}{{ ag.shift }}
                        {% endif %}
                    </td>

                    <td>{{ ag.aulas }}</td>
                    <td>{{ ag.quantidade }}</td>
                </tr>
            {% else %}
                <tr><td colspan="6">Nenhum agendamento realizado.</td></tr>
            {% endfor %}
            </tbody>
        </table>

    </div>
</body>
</html>
